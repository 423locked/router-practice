(function(t){function e(e){for(var c,u,a=e[0],i=e[1],s=e[2],l=0,b=[];l<a.length;l++)u=a[l],Object.prototype.hasOwnProperty.call(r,u)&&r[u]&&b.push(r[u][0]),r[u]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(t[c]=i[c]);d&&d(e);while(b.length)b.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],c=!0,a=1;a<n.length;a++){var i=n[a];0!==r[i]&&(c=!1)}c&&(o.splice(e--,1),t=u(u.s=n[0]))}return t}var c={},r={app:0},o=[];function u(e){if(c[e])return c[e].exports;var n=c[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=t,u.c=c,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var c in t)u.d(n,c,function(e){return t[e]}.bind(null,c));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=e,a=a.slice();for(var s=0;s<a.length;s++)e(a[s]);var d=i;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"00c4":function(t,e,n){"use strict";n("b261")},"17bf":function(t,e,n){},"3ad1":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("7a23"),r={class:"container"},o={class:"row"},u=Object(c["g"])("div",{class:"col col-sm-9"},[Object(c["g"])("h1",null,"Site")],-1),a={class:"col col-sm-3"},i={class:"alert alert-default"},s=Object(c["g"])("hr",null,null,-1),d={class:"container"},l={class:"row"},b={class:"col col-sm-3 menu"},p={class:"list-group"},f={class:"col col-sm-9"};function O(t,e,n,O,j,h){var g=Object(c["u"])("router-link"),m=Object(c["u"])("router-view");return Object(c["p"])(),Object(c["d"])("div",null,[Object(c["g"])("header",null,[Object(c["g"])("div",r,[Object(c["g"])("div",o,[u,Object(c["g"])("div",a,[Object(c["g"])("div",i,[Object(c["g"])("div",null,"In Cart: "+Object(c["w"])(t.cartLength),1),Object(c["g"])("div",null,"Total: "+Object(c["w"])(t.totalPrice(this.chosenProducts)),1)])])]),s])]),Object(c["g"])("section",null,[Object(c["g"])("div",d,[Object(c["g"])("div",l,[Object(c["g"])("div",b,[Object(c["g"])("ul",p,[(Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["t"])(t.menu,(function(t){return Object(c["p"])(),Object(c["d"])(g,{key:t.route,to:{name:t.route},custom:!0},{default:Object(c["z"])((function(e){var n=e.route,r=e.isExactActive,o=e.navigate;return[Object(c["g"])("li",{class:["list-group-item",r?"active":""]},[Object(c["g"])("a",{href:n.fullPath,onClick:o},Object(c["w"])(t.title),9,["href","onClick"])],2)]})),_:2},1032,["to"])})),128))])]),Object(c["g"])("div",f,[Object(c["g"])(m)])])])])])}var j=n("5530"),h=n("5502"),g={data:function(){return{menu:[{route:"products",title:"Products"},{route:"cart",title:"Cart"},{route:"checkout",title:"Checkout"}]}},computed:Object(j["a"])({},Object(h["c"])("cart",{cartLength:"length",totalPrice:"total",chosenProducts:"all"}))};n("92b3");g.render=O;var m=g,v=n("6c02"),k=Object(c["g"])("h1",null,"Cart Component",-1),w={key:0,class:"alert alert-danger"},P=Object(c["g"])("h2",null,"There are no products currently",-1),C={key:1};function y(t,e,n,r,o,u){var a=Object(c["u"])("edit-cart");return Object(c["p"])(),Object(c["d"])("div",null,[k,u.isEmpty?(Object(c["p"])(),Object(c["d"])("div",w,[P])):(Object(c["p"])(),Object(c["d"])("div",C,[Object(c["g"])(a)]))])}var x={class:"cart-product-cover"};function R(t,e,n,r,o,u){var a=Object(c["u"])("cart-product");return Object(c["p"])(),Object(c["d"])("div",x,[(Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["t"])(t.detailedProducts,(function(e){return Object(c["p"])(),Object(c["d"])("div",{key:e.id},[t.inCart(e.id)?(Object(c["p"])(),Object(c["d"])("div",{key:0,class:t.inCart(e.id)?"cart-product":""},[Object(c["g"])(a,{id:e.id,title:e.title,price:e.price,rest:e.rest,cnt:u.cartProductById(e.id).cnt},null,8,["id","title","price","rest","cnt"])],2)):Object(c["e"])("",!0)])})),128))])}n("7db0");var S={class:"some"};function I(t,e,n,r,o,u){return Object(c["p"])(),Object(c["d"])(c["a"],null,[Object(c["g"])("h1",null,"ID: "+Object(c["w"])(n.id),1),Object(c["g"])("h2",null,"Title: "+Object(c["w"])(n.title),1),Object(c["g"])("h2",null,"Amount: "+Object(c["w"])(n.cnt)+" / Available: "+Object(c["w"])(n.rest),1),Object(c["g"])("h2",null,"Price: "+Object(c["w"])(n.price),1),Object(c["g"])("h2",null,"Total price for "+Object(c["w"])(n.cnt)+" products: "+Object(c["w"])(u.total),1),Object(c["g"])("div",S,[Object(c["g"])("div",null,[Object(c["g"])("button",{class:"btn btn-warning",onClick:e[1]||(e[1]=function(e){return t.Decrease(n.id)})},"-1"),Object(c["g"])("button",{class:"btn btn-success",onClick:e[2]||(e[2]=function(e){return t.Increase(n.id)})},"+1")]),Object(c["g"])("div",null,[Object(c["g"])("button",{class:"btn btn-danger",onClick:e[3]||(e[3]=function(e){return t.Remove(n.id)})},"Remove")])])],64)}var T={props:["id","title","price","rest","cnt"],data:function(){return{}},computed:{total:function(){return this.price*this.cnt}},methods:Object(j["a"])({},Object(h["b"])("cart",{Increase:"Increase",Decrease:"Decrease",SetCount:"SetCount",Remove:"Remove"}))};n("00c4");T.render=I;var E=T,D={components:{CartProduct:E},data:function(){return{detailedProducts:[]}},computed:Object(j["a"])({},Object(h["c"])("cart",{cartProducts:"all",detailed:"detailedList",inCart:"has"})),methods:Object(j["a"])(Object(j["a"])({},Object(h["b"])("cart",{Increase:"Increase",Decrease:"Decrease",SetCount:"SetCount",Remove:"Remove"})),{},{cartProductById:function(t){return this.cartProducts.find((function(e){return e.id===t}))}}),mounted:function(){console.log(this.detailed(this.cartProducts)),this.detailedProducts=this.detailed(this.cartProducts)}};n("a16b");D.render=R;var _=D,A={components:{EditCart:_},data:function(){return{}},computed:Object(j["a"])(Object(j["a"])({},Object(h["c"])("cart",{cartProducts:"all"})),{},{isEmpty:function(){return 0===this.cartProducts.length}}),mounted:function(){console.log(this.$route)}};A.render=y;var L=A,M=Object(c["g"])("h1",null,"Products Component",-1),$={class:"row"},B={class:"card"},z={class:"card-body"},K=Object(c["g"])("br",null,null,-1),N=Object(c["f"])("Details"),F=Object(c["g"])("hr",null,null,-1);function J(t,e,n,r,o,u){var a=Object(c["u"])("router-link");return Object(c["p"])(),Object(c["d"])("div",null,[M,Object(c["g"])("div",$,[(Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["t"])(t.products,(function(e){return Object(c["p"])(),Object(c["d"])("div",{class:"col col-sm-4 mb-3 mt-3",key:e.id},[Object(c["g"])("div",B,[Object(c["g"])("div",z,[Object(c["g"])("h3",null,Object(c["w"])(e.title),1),Object(c["g"])("div",null,Object(c["w"])(e.price),1),K,Object(c["g"])(a,{to:"/product/".concat(e.id)},{default:Object(c["z"])((function(){return[N]})),_:2},1032,["to"]),F,t.inCart(e.id)?(Object(c["p"])(),Object(c["d"])("button",{key:1,type:"button",class:"btn btn-danger",onClick:function(n){return t.removeFromCart(e.id)}},"Remove",8,["onClick"])):(Object(c["p"])(),Object(c["d"])("button",{key:0,type:"button",class:"btn btn-success",onClick:function(n){return t.addToCart(e.id)}},"Add to Cart",8,["onClick"]))])])])})),128))])])}var V={computed:Object(j["a"])(Object(j["a"])({},Object(h["c"])("products",{products:"all"})),Object(h["c"])("cart",{inCart:"has"})),methods:Object(j["a"])({},Object(h["b"])("cart",{addToCart:"Add",removeFromCart:"Remove"}))};n("cc04");V.render=J;var U=V;function q(t,e,n,r,o,u){var a=Object(c["u"])("product"),i=Object(c["u"])("product-error");return Object(c["p"])(),Object(c["d"])("div",null,[t.isIdValid(this.id)?(Object(c["p"])(),Object(c["d"])(a,{key:0})):(Object(c["p"])(),Object(c["d"])(i,{key:1}))])}var G={class:"alert alert-success"},H=Object(c["f"])("Back to products"),Q=Object(c["g"])("hr",null,null,-1);function W(t,e,n,r,o,u){var a=Object(c["u"])("router-link");return Object(c["p"])(),Object(c["d"])("div",null,[Object(c["g"])("div",G,[Object(c["g"])("h1",null,Object(c["w"])(t.product["title"]),1),Object(c["g"])(a,{to:{name:"products"}},{default:Object(c["z"])((function(){return[H]})),_:1}),Q,Object(c["g"])("h2",null,"Price: "+Object(c["w"])(t.product["price"]),1),Object(c["f"])(" id = "+Object(c["w"])(t.id),1)])])}var X={data:function(){return{id:0,product:{}}},computed:Object(j["a"])({},Object(h["c"])("cart",{currentProduct:"product"})),mounted:function(){console.log(this.$route),this.id=this.$route["params"].id,this.product=this.currentProduct(this.id)}};X.render=W;var Y=X,Z=Object(c["g"])("h1",{class:"alert alert-danger"},"Error, no such product",-1);function tt(t,e,n,r,o,u){return Object(c["p"])(),Object(c["d"])("div",null,[Z])}var et={};et.render=tt;var nt=et,ct={components:{Product:Y,ProductError:nt},data:function(){return{id:0}},computed:Object(j["a"])({},Object(h["c"])("products",{isIdValid:"isExistent"})),created:function(){console.log(this.$route),this.id=this.$route["params"].id,console.log(this.id)}};ct.render=q;var rt=ct,ot=Object(c["g"])("h1",null,"Checkout component",-1);function ut(t,e,n,r,o,u){var a=Object(c["u"])("router-view");return Object(c["p"])(),Object(c["d"])("div",null,[ot,Object(c["g"])(a)])}var at={mounted:function(){console.log(this.$route)}};at.render=ut;var it=at;function st(t,e,n,r,o,u){return Object(c["p"])(),Object(c["d"])("h2",null,"Step 1")}var dt={};dt.render=st;var lt=dt;function bt(t,e,n,r,o,u){return Object(c["p"])(),Object(c["d"])("h2",null,"Step 2")}var pt={};pt.render=bt;var ft=pt,Ot=Object(c["g"])("h1",null,"Page not found",-1),jt=Object(c["g"])("hr",null,null,-1),ht=Object(c["f"])(" Start from main page ");function gt(t,e,n,r,o,u){return Object(c["p"])(),Object(c["d"])("div",null,[Ot,jt,ht])}var mt={};mt.render=gt;var vt=mt,kt=[{name:"products",path:"/",component:U},{name:"cart",path:"/cart",component:L},{name:"checkout",path:"/checkout",component:it,children:[{path:"",component:lt},{path:"step-2",component:ft}]},{name:"exactproduct",path:"/product/:id",component:rt},{name:"404global",path:"/:pathMatch(.*)*",component:vt}],wt=Object(v["a"])({routes:kt,history:Object(v["b"])("/")}),Pt=n("1da1");n("96cf"),n("159b"),n("d3b7"),n("25f0");function Ct(t){return yt.apply(this,arguments)}function yt(){return yt=Object(Pt["a"])(regeneratorRuntime.mark((function t(e){var n,c,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="http://faceprog.ru/reactcourseapi",t.next=3,fetch(n+e);case 3:return c=t.sent,t.next=6,c.json();case 6:return r=t.sent,t.abrupt("return",r);case 8:case"end":return t.stop()}}),t)}))),yt.apply(this,arguments)}var xt={namespaced:!0,state:{items:[]},getters:{all:function(t){return t.items},itemsMap:function(t){var e={};return t.items.forEach((function(t,n){e[t.id.toString()]=n})),e},isExistent:function(t){return function(e){return t.items.some((function(t){return t.id.toString()===e.toString()}))}},getTotalPrice:function(t){return function(e){for(var n=0,c=t.items,r=0;r<e.length;r++)for(var o=e[r].id,u=0;u<c.length;u++)c[u].id===o&&(void 0===e[r].cnt?n+=1*c[u].price:n+=c[u].price*e[r].cnt);return n}},findProductById:function(t){return function(e){return t.items.find((function(t){return t.id.toString()===e.toString()}))}},getDetailedProducts:function(t){return function(e){for(var n=[],c=t.items,r=function(t){var r=e[t].id,o=c.find((function(t){return t.id===r}));void 0!==o&&n.push(o)},o=0;o<e.length;o++)r(o);return n}}},mutations:{setItems:function(t,e){t.items=e}},actions:{load:function(t){return Object(Pt["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ct("/products/all.php");case 2:n=e.sent,console.log(n),t.commit("setItems",n);case 5:case"end":return e.stop()}}),e)})))()}}};n("4de4"),n("99af");var Rt={namespaced:!0,state:{products:[],token:null},getters:{all:function(t){return t.products},length:function(t){return t.products.filter((function(t){return t.count>0||void 0===t.count})).length},total:function(t,e,n,c){return function(t){return c["products/getTotalPrice"](t)}},has:function(t){return function(e){return t.products.some((function(t){return t.id.toString()===e.toString()}))}},item:function(t,e,n,c){return function(t){return c["products/getTotalPrice"](products)}},product:function(t,e,n,c){return function(t){return c["products/findProductById"](t)}},detailedList:function(t,e,n,c){return function(t){return c["products/getDetailedProducts"](t)}},cartProduct:function(t){return function(e){return t.products.find((function(t){return t.id.toString()===e.toString()}))}}},mutations:{add:function(t,e){t.products.push({id:e,cnt:1})},remove:function(t,e){t.products=t.products.filter((function(t){return t.id!==e}))},setCount:function(t,e){t.products.find((function(t){return t.id===e.id})).cnt=e.count},setCart:function(t,e){var n=e.token,c=e.cart;t.token=n,t.products=c,console.log(c)}},actions:{Add:function(t,e){return Object(Pt["a"])(regeneratorRuntime.mark((function n(){var c,r,o,u,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(c=t.state,r=t.getters,o=t.commit,r.has(e)){n.next=7;break}return u="/cart/add.php?token=".concat(c.token,"&id=").concat(e),n.next=5,Ct(u);case 5:a=n.sent,a&&o("add",e);case 7:case"end":return n.stop()}}),n)})))()},Remove:function(t,e){return Object(Pt["a"])(regeneratorRuntime.mark((function n(){var c,r,o,u,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(c=t.state,r=t.getters,o=t.commit,!r.has(e)){n.next=7;break}return u="/cart/remove.php?token=".concat(c.token,"&id=").concat(e),n.next=5,Ct(u);case 5:a=n.sent,a&&o("remove",e);case 7:case"end":return n.stop()}}),n)})))()},Increase:function(t,e){var n=this;return Object(Pt["a"])(regeneratorRuntime.mark((function c(){var r,o,u,a,i,s,d;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:if(r=t.state,o=t.getters,u=t.commit,!o.has(e)){c.next=12;break}if(console.log("CALLED"),a=o.product(e),i=o.cartProduct(e),!(i.cnt+1<=a["rest"])){c.next=12;break}return s="/cart/change.php?token=".concat(r.token,"&id=").concat(e,"&cnt=").concat(i.cnt+1),c.next=9,Ct(s);case 9:d=c.sent,d&&u("setCount",{id:e,count:i.cnt+1}),n.dispatch("cart/load");case 12:case"end":return c.stop()}}),c)})))()},Decrease:function(t,e){var n=this;return Object(Pt["a"])(regeneratorRuntime.mark((function c(){var r,o,u,a,i,s;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:if(r=t.state,o=t.getters,u=t.commit,!o.has(e)){c.next=11;break}if(o.product(e),a=o.cartProduct(e),!(a.cnt-1>=1)){c.next=11;break}return i="/cart/change.php?token=".concat(r.token,"&id=").concat(e,"&cnt=").concat(a.cnt-1),c.next=8,Ct(i);case 8:s=c.sent,s&&u("setCount",{id:e,count:a.cnt-1}),n.dispatch("cart/load");case 11:case"end":return c.stop()}}),c)})))()},SetCount:function(t,e,n){if(t.getters.has(e)){var c=t.getters.product(e);c["rest"]>n&&n>=0&&t.commit("setCount",{id:e,count:n})}},load:function(t){return Object(Pt["a"])(regeneratorRuntime.mark((function e(){var n,c,r,o,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=localStorage.getItem("CART_TOKEN"),e.next=3,Ct("/cart/load.php?token=".concat(n));case 3:c=e.sent,r=c.needUpdate,o=c.token,u=c.cart,r&&localStorage.setItem("CART_TOKEN",o),console.log(t.getters.all),console.log("TOKEN = ".concat(o)),t.commit("setCart",{cart:u,token:o});case 11:case"end":return e.stop()}}),e)})))()}}},St=Object(h["a"])({modules:{products:xt,cart:Rt},strict:!1}),It=(n("f9e3"),Object(c["c"])(m));It.use(St),It.use(wt),St.dispatch("cart/load"),St.dispatch("products/load").then((function(){It.mount("#app")}))},"92b3":function(t,e,n){"use strict";n("3ad1")},a16b:function(t,e,n){"use strict";n("cc3e")},b261:function(t,e,n){},cc04:function(t,e,n){"use strict";n("17bf")},cc3e:function(t,e,n){}});
//# sourceMappingURL=app.b89aa810.js.map